@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
LAYOUT_WITH_LEGEND()

System_Boundary(api_gateway, "API Gateway") {
    Component(api_controller, "API Controller", "Spring MVC or Express.js", "Handles incoming HTTP requests, validates request parameters and authentication tokens, and routes requests to the appropriate service.")
    Component(auth_module, "Authentication & Authorization Module", "Custom Module", "Implements multi-factor authentication, validates user roles and permissions, and generates and validates JWT tokens for secure access.")
    Component(request_routing, "Request Routing & Composition", "Custom Module", "Routes requests to the appropriate microservices based on the endpoint and aggregates responses from multiple services if needed.")
    Component(logging_monitoring, "Logging & Monitoring", "Custom Module", "Logs incoming requests and responses for audit trails and monitors performance metrics and error rates.")
    Component(error_handling, "Error Handling Module", "Custom Module", "Standardizes error responses across the API and handles exceptions, returning appropriate HTTP status codes.")
    Component(caching_layer, "Caching Layer", "Custom Module", "Caches frequently accessed data to improve performance.")
}

Rel(api_controller, auth_module, "Calls for user authentication and token validation")
Rel(api_controller, request_routing, "Routes requests to")
Rel(request_routing, logging_monitoring, "Logs request and response data")
Rel(request_routing, error_handling, "Handles errors during request processing")
Rel(request_routing, caching_layer, "Retrieves cached data if available")