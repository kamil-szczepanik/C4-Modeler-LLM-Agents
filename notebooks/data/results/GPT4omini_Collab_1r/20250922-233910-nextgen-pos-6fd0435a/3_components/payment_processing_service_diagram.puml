@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
LAYOUT_WITH_LEGEND()

System_Boundary(payment_processing_service, "Payment Processing Service") {
    Component(api_controller, "API Controller", "Node.js, Express", "Handles incoming HTTP requests related to payment processing, validates request data, and returns appropriate HTTP responses.")
    Component(payment_service, "Payment Service", "Node.js, Express", "Orchestrates the payment processing workflow, interacts with external payment gateways, and handles business logic for promotions.")
    Component(transaction_repository, "Transaction Repository", "Node.js, Express", "Manages data persistence for payment transactions, handles CRUD operations, and implements offline buffering logic.")
    Component(receipt_generator, "Receipt Generator", "Node.js, Express", "Generates receipts in printed and emailed formats, including QR codes for transaction details.")
    Component(error_handling_component, "Error Handling Component", "Node.js, Express", "Centralized error handling for the payment processing service, providing user feedback mechanisms for payment issues.")
}

Rel(api_controller, payment_service, "Invokes", "HTTP")
Rel(payment_service, transaction_repository, "Uses for data persistence", "Node.js, Express")
Rel(payment_service, receipt_generator, "Calls to generate receipts", "Node.js, Express")
Rel(payment_service, error_handling_component, "Utilizes for error management", "Node.js, Express")
Rel(transaction_repository, error_handling_component, "Reports errors to", "Node.js, Express")