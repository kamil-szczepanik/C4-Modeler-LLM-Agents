@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
LAYOUT_WITH_LEGEND()

System_Boundary(backend_api, "Backend API") {
    Component(api_controller, "API Controller", "Node.js", "Handle incoming HTTP requests, validate request data, and format responses.")
    Component(product_service, "ProductService", "Node.js", "Business logic for managing products.")
    Component(cart_service, "CartService", "Node.js", "Business logic for managing shopping cart operations.")
    Component(checkout_service, "CheckoutService", "Node.js", "Business logic for processing checkouts.")
    Component(review_service, "ReviewService", "Node.js", "Business logic for managing customer reviews.")
    Component(product_repository, "ProductRepository", "MongoDB", "Data access layer for product data.")
    Component(user_repository, "UserRepository", "MongoDB", "Data access layer for user data.")
    Component(review_repository, "ReviewRepository", "MongoDB", "Data access layer for review data.")
    Component(auth_middleware, "AuthMiddleware", "Node.js", "Middleware for handling authentication.")
    Component(logging_middleware, "LoggingMiddleware", "Node.js", "Middleware for logging requests and responses.")
    Component(error_handling_middleware, "ErrorHandlingMiddleware", "Node.js", "Middleware for handling errors.")
}

Rel(api_controller, product_service, "Invokes", "HTTP")
Rel(api_controller, cart_service, "Invokes", "HTTP")
Rel(api_controller, checkout_service, "Invokes", "HTTP")
Rel(api_controller, review_service, "Invokes", "HTTP")
Rel(product_service, product_repository, "Uses", "MongoDB")
Rel(cart_service, user_repository, "Uses", "MongoDB")
Rel(checkout_service, user_repository, "Uses", "MongoDB")
Rel(review_service, review_repository, "Uses", "MongoDB")
Rel(api_controller, auth_middleware, "Uses", "HTTP")
Rel(api_controller, logging_middleware, "Uses", "HTTP")
Rel(api_controller, error_handling_middleware, "Uses", "HTTP")

@enduml