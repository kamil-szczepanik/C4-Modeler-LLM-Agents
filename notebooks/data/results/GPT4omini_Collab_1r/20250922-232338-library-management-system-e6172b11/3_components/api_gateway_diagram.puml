@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml
LAYOUT_WITH_LEGEND()

System_Boundary(api_gateway, "API Gateway") {
    Component(api_controller, "API Controller", "Spring MVC", "Handle incoming HTTP requests from clients, route requests to appropriate service components, validate incoming data, and manage response formatting.")
    Component(service_layer, "Service Layer", "Spring Boot", "Implement business logic for core functionalities, coordinate between the API Controller and the Repository layer, and handle transaction management and error handling.")
    Component(repository_layer, "Repository Layer", "Spring Data", "Abstract data access logic for PostgreSQL and Elasticsearch, provide CRUD operations for catalogued items and user data, and implement caching strategies using Redis.")
    Component(domain_model, "Domain Model", "Java", "Represent core entities (e.g., Item, User, Transaction), encapsulate business rules and validation logic.")
    Component(authentication_handler, "Authentication Handler", "Spring Security", "Manage user authentication and authorization using OAuth 2.0, validate tokens and manage user sessions.")
}

Rel(api_controller, service_layer, "Delegates requests to")
Rel(service_layer, repository_layer, "Interacts for data operations")
Rel(service_layer, authentication_handler, "Validates user sessions")
Rel(repository_layer, domain_model, "Maps data to and from")
Rel(service_layer, "External Services", "Communicates with")